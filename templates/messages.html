{% extends 'base.html' %}
{% load static %}
{% block title %}Messages{% endblock title %}
{% block extra_styles %}
    <link rel="stylesheet" type="text/css" href="{% static 'js/select2/select2.css' %}"
          xmlns="http://www.w3.org/1999/html"/>
    <link rel="stylesheet" type="text/css" href="{% static 'js/select2/select2-bootstrap.css' %}" />
{% endblock %}
{% block extra_js %}
    <script type="text/javascript" src="{% static 'js/messages.js' %}"></script>
    <script type="text/javascript" language="JavaScript">
    messages = [
        {
            data_id: 1,
            category_id: 1,
            category: 'Talghy',
            course_name: 'Abbasology',
            offered_course: 'Web',
            second_course: 'DS',
            message: 'Thanks for erae',
            metoos: 0,
            metooed: false
        },
        {
            data_id: 2,
            category_id: 3,
            category: 'talaghi',
            course_name: 'Telbasology',
            offered_course: 'DA',
            second_course: '',
            message: 'مرسی  ارائه',
            metoos: 5,
            metooed: true
        },

        {
            data_id: 3,
            category_id: 1,
            category: 'Jahan eslam',
            course_name: 'شناسی',
            offered_course: 'عباس شناسی ',
            second_course: 'گوز  ',
            message: 'دلم درد می‌کنه!!',
            metoos: 15,
            metooed: false
        },


    {% for item in messages %}
        {
            {% if item.reply %}
            reply: '{{ item.reply }}',
            reply_by: '{{ item.reply_by.get_full_name }}',
            {% endif %}
            data_id: {{ item.id }},
            category_id: {{ item.category.id }},
            category: '{{ item.category }}',
            course_name: '{{ item.course_name }}',
            offered_course: '{{ item.offered_course }}',
            second_course: '{{ item.second_course }}',
            message: '{{ item.message|safe }}',
            metoos: 0, /* TODO (A'min) */
            metooed: false /* TODO (A'min) */
        },
    {% endfor %}
    ];

    $window.on('load', function() {
        showMessages(messages);
    });
    </script>

{% endblock %}
{% block body %}
    <div class="container">
        <div class="row center-block">

            <div class="col-lg-4">
                <div class="fixed-searchform">
                    {% include 'searchform.html' %}
                </div>
            </div>
            <div class="col-lg-8" id="messages-show">
                <legend>
                    Messages
                </legend>
                <div class="" id="accordion">
                    <div id="messages-container"></div>
                </div>
            </div>
        </div>
    </div>

<div class="panel panel-default hide" mj-dataid="" mj-category-id="" mj-message-template="true">
    <div class="panel-heading">
        <span class="request-id" mj-request-id></span>
        <a data-toggle="collapse" data-parent="#accordion" class="non-decoration">
            <span class="panel-title">
            <span class="conflict name" mj-course-1 mj-category="3"></span>
            <span class="conflict name" mj-course-1 mj-category="else"></span>
            : <span class="conflict category" mj-conflict-category></span>
            <span mj-category="1"> with <span class="conflict name" mj-course-2></span></span>
            </span>
        </a>
        <span class="flush-right"> <!-- FIXME (RAZI) -->
            <a href="#" class="metoo" mj-dataid="" mj-metoo-link>me too!</a>
            <span class="badge" mj-metoo-number>3</span> <!-- TODO: number of meetoos -->
        </span>
    </div>
    <div class="panel-collapse collapse in">
        <div class="panel-body good-content" mj-message-container></div>
        <div class="panel-body good-content hide" mj-reply-wrapper>
            <div mj-reply-text></div>by: <span mj-reply-name></span>
        </div>
    </div>
 </div>
{% endblock %}